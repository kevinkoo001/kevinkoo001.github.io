<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>BGP Security | Hyungjoon (Kevin) Koo</title> <meta name="author" content="Hyungjoon Koo"> <meta name="description" content=""> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?19f3075a2d19613090fe9e16b564e1fe" media="" id="highlight_theme_light"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://kevinkoo001.github.io/blog/2014/bgp-security/"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?e74e74bf055e5729d44a7d031a5ca6a5" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?96d6b3e1c3604aca8b6134c7afdd5db6"></script> <script src="/assets/js/dark_mode.js?9b17307bb950ffa2e34be0227f53558f"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/">Hyungjoon (Kevin) Koo</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">Blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">BGP Security</h1> <p class="post-meta">February 18, 2014• kevinkoo001@gmail.com</p> <p class="post-tags"> <a href="/blog/2014"> <i class="fas fa-calendar fa-sm"></i> 2014 </a>   ·   <a href="/blog/tag/bgp"> <i class="fas fa-hashtag fa-sm"></i> BGP</a>   <a href="/blog/tag/network"> <i class="fas fa-hashtag fa-sm"></i> network</a>   <a href="/blog/tag/protocol"> <i class="fas fa-hashtag fa-sm"></i> Protocol</a>     ·   <a href="/blog/category/attack-amp-defense-cyber-warfare"> <i class="fas fa-tag fa-sm"></i> Attack &amp; Defense, Cyber Warfare</a>   <a href="/blog/category/network-security"> <i class="fas fa-tag fa-sm"></i> Network Security</a>   </p> </header> <article class="post-content"> <div id="markdown-content"> <p><a href="http://dandylife.net/blog/wp-content/uploads/2014/02/BGP-Security.pdf" rel="external nofollow noopener" target="_blank">You can download the slide: BGP Security</a> (This has been done as a part of homework in CSE508 in SBU CS.)</p> <p>There are two different kinds of routing protocols: one is for interior purpose - IGP (Interior Gateway Protocol) and the other is for exterior purpose - EGP (Exterior Gateway Protocol). A good example of IGP would be RIP(Routing Information Protocol), OSPF (Open Shortest Path First) which is the most widely used, and EIGRP (Enhanced Interior Gateway Routing Protocol) which is proprietary by Cisco. In EGP, BGP (Border Gateway Protocol) is now de facto standard adapted by the Internet.</p> <p>First we need to define a couple of terminologies.</p> <ol> <li>AS (Autonomous System): A set of computers and routers under a single administration</li> <li>RIB (Routing Information Base): BGP routing entries (Adj-RIB-In, Loc-RIB, and Adj-RIB-Out)</li> <li>BGP Attribute: Types to decide path vector algorithm (Origin=1, AS_Path=2, Next_Hop=3, MED=4, Local_Pref=5, Atomic_Aggregate=6, Aggregator=7)</li> </ol> <p>As of Feb. 2014, there are more than 500,000 BGP routing tables available. (Check <a href="http://bgp.potaroo.net/bgprpts/rva-index.html" rel="external nofollow noopener" target="_blank">http://bgp.potaroo.net/bgprpts/rva-index.html</a>) You may also want to know current AS summary. (Check <a href="http://cidr-report.org/as2.0/" rel="external nofollow noopener" target="_blank">http://cidr-report.org/as2.0/</a>) Each BGP speaker uses RIBs and BGP attributes and installs NLRI (or best path) according to the following mechanism. (If the preference ties, then it considers next attribute in order.)</p> <p><strong>Highest weight →Highest LOCAL-PREF → Originated Source → Shortest AS-PATH → Lowest Origin (IBGP &lt; EBGP &lt; incomplete) → Lowest MED → EBGP over IBGP → Lowest IGP Metric → Lowest Route ID → Lowest Originator ID</strong></p> <p>The following figure illustrates 4 main BGP messages: OPEN, KEEP-ALIVE, UPDATE, and NOTIFICATION. The communication among BGP speakers maintains unicast over 179/tcp.</p> <p><a href="http://dandylife.net/blog/wp-content/uploads/2014/02/bgp1.jpg" rel="external nofollow noopener" target="_blank"><img src="http://dandylife.net/blog/wp-content/uploads/2014/02/bgp1.jpg" alt="bgp1"></a></p> <p>Now, let’s briefly take a look at BGP vulnerabilities from two perspectives. By running over TCP, listening on port 179, BGP is subject to be vulnerable through all kinds of TCP attacks: IP Spoofing, TCP RST,  TCP RST using ICMP, Session Hijacking, and various denial of service attacks including SYN flooding and so forth. These lead target router to drop the BGP session and both peers withdraw routes, causing disruption of network connection. An attacker takes advantage of eavesdropping, blackholing, and/or traffic analysis by changing routes as well.</p> <p><a href="http://dandylife.net/blog/wp-content/uploads/2014/02/bgp2.jpg" rel="external nofollow noopener" target="_blank"><img src="http://dandylife.net/blog/wp-content/uploads/2014/02/bgp2.jpg" alt="bgp2"></a></p> <p>On top of that, with respect to BGP attacks, fundamental vulnerabilities arise from no mechanism which has specified within BGP in order to (a) validate the authority of an AS and (b) to ensure the authenticity of the path attribute by an AS. This allows an adversary to route manipulation such as message relaying, insertion, deletion, and modification as well as route hijacking. BGP-oriented attacks include:</p> <p>(1) Route Flapping: repetitive changes rapidly cause the BGP routing table to be withdrawn and then re-advertised (2) Route Deaggregation: announcing more specific route UPDATE causes a huge number of updates, which makes router crash and shut down (3) (Unallocated) Route Injection: sending out incorrect routing information or transmitting routes to “bogon” prefixes</p> <p><a href="http://dandylife.net/blog/wp-content/uploads/2014/02/bgp3.jpg" rel="external nofollow noopener" target="_blank"><img src="http://dandylife.net/blog/wp-content/uploads/2014/02/bgp3.jpg" alt="bgp3"></a></p> <p>Lastly, here are BGP attack countermeasures to mitigate corresponding threats above.</p> <p><strong>1. Use authentication mechanism</strong></p> <ul> <li> <p>Use access control list.</p> </li> <li> <p>Use BGP peer authentication: MD5(Routing Advertisement + Shared Key), IPSecif available</p> </li> <li> <p>Configure BGP to allow announcing only designated netblocks</p> </li> <li> <p>Disable BGP version negotiation to provide faster startup</p> </li> <li> <p>Announce only preconfigured list of networks</p> </li> </ul> <p><strong>2. Configure route manipulation protection</strong></p> <ul> <li> <p>Use BGP graceful restart</p> </li> <li> <p>Use max prefix limits to avoid filling router tables</p> </li> <li> <p>Filter all bogonprefixes with ingress/egress filtering</p> </li> <li> <p>Do not allow over-specific prefixes</p> </li> <li> <p>Turn off fast external failover, called route flap damping</p> </li> <li> <p>Record peer changes</p> </li> </ul> <p><strong>3. Use secure protocol</strong></p> <ul> <li> <p>Only allow peers to connect to port 179 in TCP</p> </li> <li> <p>Randomize sequence number (against spoofing and session hijacking)</p> </li> <li> <p>Consider deploying S-BGP or BGPSec</p> </li> </ul> <p><strong>[References]</strong></p> <p>RFC 4271 -A Border Gateway Protocol 4 (BGP-4), which obsoletes RFC 1771, 1772 RFC 4272 -BGP Security Vulnerabilities Analysis RFC 2439 –BGP Route Flap Damping <a href="http://www.cisco.com/web/about/security/intelligence/protecting_bgp.html%20BGP%20Security" rel="external nofollow noopener" target="_blank">http://moo.cmcl.cs.cmu.edu/~dwendlan/routing/</a> <a href="http://www.cisco.com/web/about/security/intelligence/protecting_bgp.html" rel="external nofollow noopener" target="_blank">http://www.cisco.com/web/about/security/intelligence/protecting_bgp.html</a></p> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2016/code-reuse-attacks-and-defenses/">Code Reuse Attacks and Defenses</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2018/compiler-assisted-code-randomization/">Compiler-assisted Code Randomization</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2016/juggling-the-gadgets-instruction-displacement-to-mitigate-code-reuse-attack/">Juggling the Gadgets: Instruction Displacement to Mitigate Code Reuse Attack</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2014/rootkit-module-in-linux-kernel-3-2/">Rootkit module in Linux Kernel 3.2</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2013/malware-and-its-use-of-implemented-anonymous-networks-2/">Malware and its Use of Implemented Anonymous Networks</a> </li> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2024 Hyungjoon Koo. Last updated: September 04, 2024. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?7b30caa5023af4af8408a472dc4e1ebb"></script> <script defer src="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?c9d9dd48933de3831b3ee5ec9c209cac" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>